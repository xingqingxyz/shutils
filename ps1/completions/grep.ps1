Register-ArgumentCompleter -Native -CommandName grep -ScriptBlock {
  param ([string]$wordToComplete)
  @(if ($wordToComplete.StartsWith('-')) {
      '-E', '--extended-regexp', '-F', '--fixed-strings', '-G', '--basic-regexp', '-P', '--perl-regexp', '-e', '--regexp=', '-f', '--file=', '-i', '--ignore-case', '--no-ignore-case', '-w', '--word-regexp', '-x', '--line-regexp', '-z', '--null-data', '-s', '--no-messages', '-v', '--invert-match', '-V', '--version', '--help', '-m', '--max-count=', '-b', '--byte-offset', '-n', '--line-number', '--line-buffered', '-H', '--with-filename', '-h', '--no-filename', '--label=', '-o', '--only-matching', '-q', '--quiet', '--silent', '--binary-files=binary', '--binary-files=text', '--binary-files=without-match', '-a', '--text', '-I', '-d', '--directories=read', '--directories=recurse', '--directories=skip', '-D', '--devices=read', '--devices=skip', '-r', '--recursive', '-R', '--dereference-recursive', '--include=', '--exclude=', '--exclude-from=', '--exclude-dir=', '-L', '--files-without-match', '-l', '--files-with-matches', '-c', '--count', '-T', '--initial-tab', '-Z', '--null', '-B', '--before-context=', '-A', '--after-context=', '-C', '--context=', '--group-separator=', '--no-group-separator', '--color', '--color=auto', '--color=always', '--color=never', '--colour', '-U', '--binary'
    }).Where{ $_ -like "$wordToComplete*" }
}
