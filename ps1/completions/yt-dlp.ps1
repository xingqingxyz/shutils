Register-ArgumentCompleter -Native -CommandName yt-dlp -ScriptBlock {
  param ([string]$wordToComplete, [System.Management.Automation.Language.CommandAst]$commandAst, [int]$cursorPosition)
  @(if ($wordToComplete.StartsWith('-')) {
      '-h', '--help', '--version', '-U', '--update', '--no-update', '--update-to=', '--update-to=stable@latest', '--update-to=nightly@latest', '--update-to=master@latest', '-i', '--ignore-errors', '--no-abort-on-error', '--abort-on-error', '--list-extractors', '--extractor-descriptions', '--use-extractors=', '--default-search', '--ignore-config', '--no-config-locations', '--config-locations', '--plugin-dirs', '--no-plugin-dirs', '--flat-playlist', '--no-flat-playlist', '--live-from-start', '--no-live-from-start', '--wait-for-video', '--no-wait-for-video', '--mark-watched', '--no-mark-watched', '--color', '--color=always', '--color=auto', '--color=auto-tty', '--color=never', '--color=no_color-tty', '--compat-options', '--alias', '-t', '--preset-alias=', '--preset-alias=aac', '--preset-alias=mkv', '--preset-alias=mp3', '--preset-alias=mp4', '--preset-alias=sleep', '--proxy', '--socket-timeout', '--source-address', '--impersonate', '--list-impersonate-targets', '-4', '--force-ipv4', '-6', '--force-ipv6', '--enable-file-urls', '--geo-verification-proxy', '--xff=', '--xff=default', '--xff=never', '-I', '--playlist-items', '--min-filesize', '--max-filesize', '--date', '--datebefore', '--dateafter', '--match-filters=', '--no-match-filters', '--break-match-filters=', '--no-break-match-filters', '--no-playlist', '--yes-playlist', '--age-limit=', '--download-archive=', '--no-download-archive', '--max-downloads=', '--max-downloads=5', '--break-on-existing', '--no-break-on-existing', '--break-per-input', '--no-break-per-input', '--skip-playlist-after-errors=', '--skip-playlist-after-errors=20', '-5', '--concurrent-fragments=', '--concurrent-fragments=5', '-r', '--limit-rate', '--throttled-rate', '-R', '--retries=', '--retries=10', '--file-access-retries', '--fragment-retries', '--retry-sleep', '--skip-unavailable-fragments', '--abort-on-unavailable-fragments', '--keep-fragments', '--no-keep-fragments', '--buffer-size', '--resize-buffer', '--no-resize-buffer', '--http-chunk-size', '--playlist-random', '--lazy-playlist', '--no-lazy-playlist', '--hls-use-mpegts', '--no-hls-use-mpegts', '--download-sections', '--downloader', '--downloader-args', '-a', '--batch-file', '--no-batch-file', '-P', '--paths', '-o', '--output', '--output-na-placeholder', '--restrict-filenames', '--no-restrict-filenames', '--windows-filenames', '--no-windows-filenames', '--trim-filenames', '-w', '--no-overwrites', '--force-overwrites', '--no-force-overwrites', '-c', '--continue', '--no-continue', '--part', '--no-part', '--mtime', '--no-mtime', '--write-description', '--no-write-description', '--write-info-json', '--no-write-info-json', '--write-playlist-metafiles', '--no-write-playlist-metafiles', '--clean-info-json', '--no-clean-info-json', '--write-comments', '--no-write-comments', '--load-info-json FILE', '--cookies FILE', '--no-cookies', '--cookies-from-browser=', '--cookies-from-browser=chrome', '--cookies-from-browser=chromium', '--cookies-from-browser=edge', '--cookies-from-browser=firefox', '--cookies-from-browser=safari', '--no-cookies-from-browser', '--cache-dir', '--no-cache-dir', '--rm-cache-dir', '--write-thumbnail', '--no-write-thumbnail', '--write-all-thumbnails', '--list-thumbnails', '--write-link', '--write-url-link', '--write-webloc-link', '--write-desktop-link', '-q', '--quiet', '--no-quiet', '--no-warnings', '-s', '--simulate', '--no-simulate', '--ignore-no-formats-error', '--no-ignore-no-formats-error', '--skip-download', '-O', '--print', '--print-to-file', '-j', '--dump-json', '-J', '--dump-single-json', '--force-write-archive', '--newline', '--no-progress', '--progress', '--console-title', '--progress-template', '--progress-delta', '-v', '--verbose', '--dump-pages', '--write-pages', '--print-traffic', '--encoding', '--legacy-server-connect', '--no-check-certificates', '--prefer-insecure', '--add-headers', '--bidi-workaround', '--sleep-requests', '--sleep-interval', '--max-sleep-interval', '--sleep-subtitles', '-f', '--format', '-S', '--format-sort', '--format-sort-force', '--no-format-sort-force', '--video-multistreams', '--no-video-multistreams', '--audio-multistreams', '--no-audio-multistreams', '--prefer-free-formats', '--no-prefer-free-formats', '--check-formats', '--check-all-formats', '--no-check-formats', '-F', '--list-formats', '--merge-output-format', '--write-subs', '--no-write-subs', '--write-auto-subs', '--no-write-auto-subs', '--list-subs', '--sub-format', '--sub-langs', '-u', '--username', '-p', '--password', '-2', '--twofactor', '-n', '--netrc', '--netrc-location', '--netrc-cmd', '--video-password', '--ap-mso', '--ap-username', '--ap-password', '--ap-list-mso', '--client-certificate', '--client-certificate-key', '--client-certificate-password', '-x', '--extract-audio', '--audio-format=', '--audio-format=best', '--audio-format=aac', '--audio-format=alac', '--audio-format=flac', '--audio-format=m4a', '--audio-format=mp3', '--audio-format=opus', '--audio-format=vorbis', '--audio-format=wav', '--audio-quality=', '--audio-quality=0', '--audio-quality=10', '--remux-video', '--recode-video', '--postprocessor-args', '--ppa', '-k', '--keep-video', '--no-keep-video', '--post-overwrites', '--no-post-overwrites', '--embed-subs', '--no-embed-subs', '--embed-thumbnail', '--no-embed-thumbnail', '--embed-metadata', '--no-embed-metadata', '--embed-chapters', '--no-embed-chapters', '--embed-info-json', '--no-embed-info-json', '--parse-metadata', '--replace-in-metadata', '--xattrs', '--concat-playlist=', '--concat-playlist=never', '--concat-playlist=always', '--concat-playlist=multi_video', '--fixup', '--ffmpeg-location', '--exec', '--no-exec', '--convert-subs', '--convert-thumbnails', '--split-chapters', '--no-split-chapters', '--remove-chapters', '--no-remove-chapters', '--force-keyframes-at-cuts', '--no-force-keyframes-at-cuts', '--use-postprocessor=', '--use-postprocessor=pre_process', '--use-postprocessor=after_filter', '--use-postprocessor=video', '--sponsorblock-mark', '--sponsorblock-remove', '--sponsorblock-chapter-title', '--no-sponsorblock', '--sponsorblock-api', '--extractor-retries=', '--extractor-retries=3', '--extractor-retries=infinite', '--allow-dynamic-mpd', '--ignore-dynamic-mpd', '--hls-split-discontinuity', '--no-hls-split-discontinuity', '--extractor-args', '-tmp3', '-taac', '-tmp4', '-tmkv', '-tsleep'
    }).Where{ $_ -like "$wordToComplete*" }
}
