Register-ArgumentCompleter -Native -CommandName emulator -ScriptBlock {
  param ([string]$wordToComplete, [System.Management.Automation.Language.CommandAst]$commandAst, [int]$cursorPosition)
  @(if ($wordToComplete.StartsWith('-')) {
      '-list-avds', '-sysdir', '-system', '-vendor', '-writable-system', '-delay-adb', '-datadir', '-kernel', '-ramdisk', '-image', '-initdata', '-data', '-encryption-key', '-logcat-output', '-partition-size', '-cache', '-cache-size', '-no-cache', '-nocache', '-sdcard', '-quit-after-boot 120', '-quit-after-boot 180', '-qemu-top-dir', '-monitor-adb error', '-monitor-adb info', '-monitor-adb not', '-monitor-adb verbose', '-monitor-adb warning', '-snapstorage', '-no-snapstorage', '-snapshot', '-no-snapshot', '-no-snapshot-save', '-no-snapshot-load', '-force-snapshot-load', '-qcow2-for-userdata', '-snapshot-list', '-no-snapshot-update-time', '-wipe-data', '-avd', '-avd-arch x64', '-avd-arch arm64', '-skindir', '-skin', '-no-skin', '-noskin', '-memory', '-ui-only zh_CN', '-id', '-cores 8', '-accel', '-accel off', '-no-accel', '-ranchu', '-engine auto', '-engine classic', '-engine qemu2', '-netspeed 3', '-netdelay 60', '-netfast', '-code-profile', '-show-kernel', '-shell', '-no-jni', '-nojni', '-dalvik-vm-checkjni', '-logcat', '-log-nofilter', '-log-detailed', '-no-audio', '-noaudio', '-audio', '-radio', '-port 4037', '-ports 4037`,5037', '-modem-simulator-port 6037', '-onion', '-onion-alpha %79', '-onion-rotation 0', '-onion-rotation 1', '-onion-rotation 2', '-onion-rotation 3', '-dpi-device 720', '-scale 1.0', '-wifi-client-port 5199', '-wifi-server-port 5198', '-http-proxy localhost:9078', '-timezone', '-change-language cn', '-change-country zh', '-change-locale zh-cn', '-dns-server', '-net-tap', '-net-socket', '-net-tap-script-up', '-net-tap-script-down', '-cpu-delay', '-no-boot-anim', '-no-window', '-qt-hide-window', '-no-sim', '-lowram', '-version', '-no-passive-gps', '-gnss-file-path', '-gnss-grpc-port', '-virtio-console', '-read-only', '-is-restart', '-report-console ws://', '-gps', '-shell-serial', '-tcpdump', '-bootchart 120', '-bootchart 180', '-charmap', '-studio-params', '-prop', '-shared-net-id 10.1.2.1', '-gpu', '-use-host-vulkan', '-vsync-rate 30', '-camera-back', '-camera-front', '-webcam-list', '-virtualscene-poster', '-screen', '-selinux disabled', '-selinux permissive', '-unix-pipe', '-fixed-scale', '-wait-for-debugger', '-skip-adb-auth', '-metrics-to-console', '-metrics-collection', '-metrics-to-file', '-no-metrics', '-detect-image-hang', '-feature', '-icc-profile', '-sim-access-rules-file', '-phone-number', '-acpi-config', '-fuchsia', '-window-size', '-allow-host-audio', '-restart-when-stalled', '-perf-stat', '-share-vid', '-grp', '-grpc-tls-key', '-grpc-tls-cer', '-grpc-tls-ca', '-grpc-use-token', '-grpc-use-jwt', '-grpc-allowlist', '-idle-grpc-timeout 180', '-idle-grpc-timeout 120', '-waterfall', '-grpc-ui', '-packet-streamer-endpoint', '-netsim-args', '-multidisplay', '-google-maps-key', '-no-location-ui', '-use-keycode-forwarding', '-record-session', '-legacy-fake-camera', '-camera-hq-edge', '-no-direct-adb', '-check-snapshot-loadable', '-no-hidpi-scaling', '-no-mouse-reposition', '-guest-angle', '-usb-passthrough', '-append-userspace-opt', '-save-path', '-no-nested-warnings', '-wifi-tap', '-wifi-tap-script-up', '-wifi-tap-script-down', '-wifi-socket', '-wifi-user-mode-options', '-network-user-mode-options', '-adb-path', '-hotplug-multi-display', '-xts', '-wifi-mac-address', '-no-ethernet', '-android-serialno', '-support-multiple-input-modaliti', '-hands-in-space', '-systemui-renderer', '-is-ost', '-qemu', '-qemu', '-verbose', '-debug', '-debug-', '-debug-no-', '-help', '-help-list-avds', '-help-sysdir', '-help-system', '-help-vendor', '-help-writable-system', '-help-delay-adb', '-help-datadir', '-help-kernel', '-help-ramdisk', '-help-image', '-help-initdata', '-help-data', '-help-encryption-key', '-help-logcat-output', '-help-partition-size', '-help-cache', '-help-cache-size', '-help-no-cache', '-help-nocache', '-help-sdcard', '-help-quit-after-boot', '-help-qemu-top-dir', '-help-monitor-adb', '-help-snapstorage', '-help-no-snapstorage', '-help-snapshot', '-help-no-snapshot', '-help-no-snapshot-save', '-help-no-snapshot-load', '-help-force-snapshot-load', '-help-qcow2-for-userdata', '-help-snapshot-list', '-help-no-snapshot-update-time', '-help-wipe-data', '-help-avd', '-help-avd-arch', '-help-skindir', '-help-skin', '-help-no-skin', '-help-noskin', '-help-memory', '-help-ui-only', '-help-id', '-help-cores', '-help-accel', '-help-no-accel', '-help-ranchu', '-help-engine', '-help-netspeed', '-help-netdelay', '-help-netfast', '-help-code-profile', '-help-show-kernel', '-help-shell', '-help-no-jni', '-help-nojni', '-help-dalvik-vm-checkjni', '-help-logcat', '-help-log-nofilter', '-help-log-detailed', '-help-no-audio', '-help-noaudio', '-help-audio', '-help-radio', '-help-port', '-help-ports', '-help-modem-simulator-port', '-help-onion', '-help-onion-alpha', '-help-onion-rotation', '-help-dpi-device', '-help-scale', '-help-wifi-client-port', '-help-wifi-server-port', '-help-http-proxy', '-help-timezone', '-help-change-language', '-help-change-country', '-help-change-locale', '-help-dns-server', '-help-net-tap', '-help-net-socket', '-help-net-tap-script-up', '-help-net-tap-script-down', '-help-cpu-delay', '-help-no-boot-anim', '-help-no-window', '-help-qt-hide-window', '-help-no-sim', '-help-lowram', '-help-version', '-help-no-passive-gps', '-help-gnss-file-path', '-help-gnss-grpc-port', '-help-virtio-console', '-help-read-only', '-help-is-restart', '-help-report-console', '-help-gps', '-help-shell-serial', '-help-tcpdump', '-help-bootchart', '-help-charmap', '-help-studio-params', '-help-prop', '-help-shared-net-id', '-help-gpu', '-help-use-host-vulkan', '-help-vsync-rate', '-help-camera-back', '-help-camera-front', '-help-webcam-list', '-help-virtualscene-poster', '-help-screen', '-help-selinux', '-help-unix-pipe', '-help-fixed-scale', '-help-wait-for-debugger', '-help-skip-adb-auth', '-help-metrics-to-console', '-help-metrics-collection', '-help-metrics-to-file', '-help-no-metrics', '-help-detect-image-hang', '-help-feature', '-help-icc-profile', '-help-sim-access-rules-file', '-help-phone-number', '-help-acpi-config', '-help-fuchsia', '-help-window-size', '-help-allow-host-audio', '-help-restart-when-stalled', '-help-perf-stat', '-help-share-vid', '-help-grp', '-help-grpc-tls-key', '-help-grpc-tls-cer', '-help-grpc-tls-ca', '-help-grpc-use-token', '-help-grpc-use-jwt', '-help-grpc-allowlist', '-help-idle-grpc-timeout', '-help-waterfall', '-help-grpc-ui', '-help-packet-streamer-endpoint', '-help-netsim-args', '-help-multidisplay', '-help-google-maps-key', '-help-no-location-ui', '-help-use-keycode-forwarding', '-help-record-session', '-help-legacy-fake-camera', '-help-camera-hq-edge', '-help-no-direct-adb', '-help-check-snapshot-loadable', '-help-no-hidpi-scaling', '-help-no-mouse-reposition', '-help-guest-angle', '-help-usb-passthrough', '-help-append-userspace-opt', '-help-save-path', '-help-no-nested-warnings', '-help-wifi-tap', '-help-wifi-tap-script-up', '-help-wifi-tap-script-down', '-help-wifi-socket', '-help-wifi-user-mode-options', '-help-network-user-mode-options', '-help-adb-path', '-help-hotplug-multi-display', '-help-xts', '-help-wifi-mac-address', '-help-no-ethernet', '-help-android-serialno', '-help-support-multiple-input-modaliti', '-help-hands-in-space', '-help-systemui-renderer', '-help-is-ost', '-help-qemu', '-help-verbose', '-help-debug', '-help-disk-images', '-help-debug-tags', '-help-char-devices', '-help-environment', '-help-virtual-device', '-help-sdk-images', '-help-build-images', '-help-all'
    }).Where{ $_ -like "$wordToComplete*" }
}
