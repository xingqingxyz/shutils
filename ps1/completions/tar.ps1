Register-ArgumentCompleter -Native -CommandName tar -ScriptBlock {
  param ([string]$wordToComplete)
  @(if ($wordToComplete.StartsWith('-')) {
      '-A', '--catenate', '--concatenate', '-c', '--create', '--delete', '-d', '--diff', '--compare', '-r', '--append', '--test-label', '-t', '--list', '-u', '--update', '-x', '--extract', '--get', '--check-device', '-g', '--listed-incremental=', '-G', '--incremental', '--hole-detection=', '--ignore-failed-read', '--level=', '--no-check-device', '--no-seek', '-n', '--seek', '--occurrence', '--occurrence=2', '--sparse-version=', '-S', '--sparse', '--add-file=', '-C', '--directory=', '--exclude=', '--exclude-backups', '--exclude-caches', '--exclude-caches-all', '--exclude-caches-under', '--exclude-ignore=', '--exclude-ignore-recursive=', '--exclude-tag=', '--exclude-tag-all=', '--exclude-tag-under=', '--exclude-vcs', '--exclude-vcs-ignores', '--no-null', '--no-recursion', '--no-unquote', '--no-verbatim-files-from -T', '--null', '--recursion', '-T', '--files-from=', '--unquote', '--verbatim-files-from -T', '-X', '--exclude-from=', '--anchored', '--ignore-case', '--no-anchored', '--no-ignore-case', '--no-wildcards', '--no-wildcards-match-slash', '--wildcards', '--wildcards-match-slash', '--keep-directory-symlink', '--keep-newer-files', '-k', '--keep-old-files', '--no-overwrite-dir', '--one-top-level', '--one-top-level=', '--overwrite', '--overwrite-dir', '--recursive-unlink', '--remove-files', '--skip-old-files', '-U', '--unlink-first', '-W', '--verify', '--ignore-command-error', '--no-ignore-command-error', '-O', '--to-stdout', '--to-command=', '--atime-preserve', '--atime-preserve=system', '--atime-preserve=replace', '--clamp-mtime', '--delay-directory-restore', '--group=', '--group-map=', '--mode=755', '--mode=644', '--mtime=', '-m', '--touch', '--no-delay-directory-restore', '--no-same-owner', '--no-same-permissions', '--numeric-owner', '--owner=', '--owner-map=', '-p', '--preserve-permissions', '--same-permissions', '--same-owner', '--sort=', '--sort=name', '--sort=inode', '--sort=none', '-s', '--preserve-order', '--same-order', '--acls', '--no-acls', '--no-selinux', '--no-xattrs', '--selinux', '--xattrs', '--xattrs-exclude=', '--xattrs-include=', '--force-local', '-f', '--file=', '-F', '--info-script=', '--new-volume-script=', '-L', '--tape-length=', '-M', '--multi-volume', '--rmt-command=/etc/rmt', '--rsh-command=/usr/bin/ssh', '--volno-file=', '-b', '--blocking-factor=', '-B', '--read-full-records', '-i', '--ignore-zeros', '--record-size=', '-H', '--format=gnu', '--format=oldgnu', '--format=pax', '--format=posix', '--format=ustar', '--format=v7', '--old-archive', '--portability', '--pax-option=', '--posix', '-V', '--label=', '-a', '--auto-compress', '-I', '--use-compress-program=', '-j', '--bzip2', '-J', '--xz', '--lzip', '--lzma', '--lzop', '--no-auto-compress', '--zstd', '-z', '--gzip', '--gunzip', '--ungzip', '-Z', '--compress', '--uncompress', '--backup', '--backup=', '--hard-dereference', '-h', '--dereference', '-K', '--starting-file=', '--newer-mtime=', '-N', '--newer=', '--after-date=', '--one-file-system', '-P', '--absolute-names', '--suffix=~', '--strip-components=', '--transform=', '--xform=', '--checkpoint', '--checkpoint=10', '--checkpoint-action=', '--full-time', '--index-file=', '-l', '--check-links', '--no-quote-chars=', '--quote-chars=', '--quoting-style=literal', '--quoting-style=shell', '--quoting-style=shell-always', '--quoting-style=shell-escape', '--quoting-style=shell-escape-always', '--quoting-style=c', '--quoting-style=c-maybe', '--quoting-style=escape', '--quoting-style=locale', '--quoting-style=clocale', '-R', '--block-number', '--show-defaults', '--show-omitted-dirs', '--show-snapshot-field-ranges', '--show-transformed-names', '--show-stored-names', '--totals', '--totals=HUP', '--totals=QUIT', '--totals=INT', '--totals=USR1', '--totals=USR2', '--totals=SIGHUP', '--totals=SIGQUIT', '--totals=SIGINT', '--totals=SIGUSR1', '--totals=SIGUSR2', '--utc', '-v', '--verbose', '--warning=WARNING', '-w', '--interactive', '--confirmation', '-o', '-?', '--help', '--restrict', '--usage', '--version'
    }).Where{ $_ -like "$wordToComplete*" }
}
